---
import { getCollection } from "astro:content";

const nonce = Astro.locals.nonce;

const posts = (await getCollection("en/blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

// Get the 3 most recent posts for the grid
const recentPosts = posts.slice(0, 3);
---

<html lang="pl">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/images/Kunke_Favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles/global.css" nonce={nonce} />
    <title>Blog | ^Kunke Consulting - AI, Excel i Doradztwo</title>
    <meta name="description" content="Blog ^Kunke Consulting - najnowsze artykuły o AI, Excel i doradztwie biznesowym" />
  </head>

  <body>
    <!-- Header with breadcrumb and follow link -->
    <header class="blog-header">
      <nav class="breadcrumb">
        <a href="/">Home</a> > <span>^Kunke Consulting BLOG</span>
      </nav>
      <a href="https://www.linkedin.com/in/blazejkunke/" class="follow-link" target="_blank" rel="noopener noreferrer">FOLLOW US</a>
    </header>

    <!-- Main blog title section -->
    <section class="blog-title-section">
      <h1>^Kunke Consulting Blog</h1>
      <p class="subtitle">AI, Excel i Doradztwo</p>
    </section>

    <!-- Hero workshop promotion -->
    <section class="blog-hero">
      <a href="/blog/warsztaty-ai/" class="hero-block">
        <div class="hero-image">
          <img src="/images/ai-workshop-hero.png" alt="AI Workshop illustration" loading="eager" decoding="async" width="600" height="400" />
        </div>
        <div class="hero-content">
          <h2>Warsztaty AI</h2>
          <p>Kompleksowe szkolenia AI dla polskich firm. Praktyczne narzędzia, które wdrożysz już jutro w swojej organizacji.</p>
          <span class="hero-arrow">→</span>
        </div>
      </a>
    </section>

    <!-- Recent posts grid -->
    <section class="blog-grid-section">
      <div class="blog-posts-grid">
        {recentPosts.map((post) => (
          <article class="blog-post-card">
            <a href={`/blog/${post.slug}/`}>
              <div class="post-image">
                <img src={post.data.heroImage || `/images/blog-placeholder-${Math.floor(Math.random() * 3) + 1}.jpg`} alt={post.data.title} loading="lazy" decoding="async" width="400" height="250" />
              </div>
              <h3>{post.data.title}</h3>
            </a>
          </article>
        ))}
      </div>
    </section>

    <!-- All posts section -->
    <section class="all-posts-section">
      <h2>Wszystkie artykuły</h2>
      <div class="all-posts-list">
        {posts.map((post) => (
          <article class="post-list-item">
            <time>{post.data.date.toLocaleDateString('pl-PL')}</time>
            <h3><a href={`/blog/${post.slug}/`}>{post.data.title}</a></h3>
            <p>{post.data.description}</p>
          </article>
        ))}
      </div>
    </section>

    <!-- Footer link -->
    <footer class="blog-footer">
      <a href="/">← Powrót do strony głównej</a>
    </footer>
  </body>
</html>